app.directive("dynchart",function(){return{scope:{data:"="},link:function(o,i){i.sparkline(o.data,{type:"line",width:"100%",height:"50",lineWidth:2,maxSpotColor:"#ff0000",spotRadius:3,normalRangeMin:0,normalRangeMax:6,normalRangeColor:"#e5e5e5"})}}}),Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)},app.controller("aoicollectorController",["$scope","$http","$interval","toasty",function(o,i,e,t){o.aoiList=[],o.nodejserror=!0,o.runtime="";const n=ws("arushap34:3333",{}),r=n.channel("aoicollectormonitor");r.connect(function(i,e){return i?(console.log(i),void(o.nodejserror=!0)):(o.nodejserror=!1,console.log("AoicollectorMonitor Connected"),r.emit("AoicollectorMonitorSubscribe"),void o.$apply())}),r.on("disconnect",function(){console.log("AoicollectorMonitor Disconnected"),o.nodejserror=!0,o.$apply()}),r.on("AoicollectorMonitorChannel",function(i){var e=10,t=JSON.parse(i);switch(t.mode){case"runtime":0==t.total?o.runtime="No hay inspecciones":o.runtime="Procesando "+t.current+" de "+t.total;break;default:t.tiempoEjecucion=(t.tiempoEjecucion/1e3).toFixed(2);for(var n=!1,r=0;r<o.aoiList.length;r++)if(o.aoiList[r].aoibarcode==t.aoibarcode){t.runtimeHistory=o.aoiList[r].runtimeHistory,t.runtimeHistory.push(t.tiempoEjecucion),t.tiempoEjecucion>o.aoiList[r].tiempoEjecucionMax?t.tiempoEjecucionMax=t.tiempoEjecucion:t.tiempoEjecucionMax=o.aoiList[r].tiempoEjecucionMax,t.runtimeHistory.length>e&&(t.runtimeHistory=t.runtimeHistory.slice(1,11),t.tiempoEjecucionMax=Math.max.apply(null,t.runtimeHistory)),o.aoiList[r]=t,n=!0;break}n||(t.runtimeHistory=[0,t.tiempoEjecucion],t.tiempoEjecucionMax=t.tiempoEjecucion,o.aoiList.push(t))}o.$apply()})}]);